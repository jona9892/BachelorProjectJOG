@using Infocenter_Screen.Models.ViewModels

@model KantineViewModel

<style>
    #SW {
        position: fixed;
        width: 50%;
        height: 43%;
        max-height: 43%;
        top: 50%;
        left: 0;
        overflow: hidden;
        background: #ffffff;
        border-color: #42678A;
    }

    #PTET {
        position: fixed;
        width: 50%;
        height: 25%;
        top: 0;
        left: 50%;
        background: #ffffff;
        display: table;
    }

    .helper {
        display: inline-block;
        height: 100%;
        vertical-align: middle;
    }

    .table-striped > tbody > tr:nth-child(2n+1) > td, .table-striped > tbody > tr:nth-child(2n+1) > th {
        background-color: #EBF4FA;
    }
</style>

@section scripts{
    <!--Script references. -->
    <!--The jQuery library is required and is referenced by default in _Layout.cshtml. -->
    <!--Reference the SignalR library. -->
    <script src="~/Scripts/jquery.signalR-2.2.2.min.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="~/signalr/hubs"></script>
    <!--SignalR script to update the chat page and send messages.-->
    <script>
        $(function () {
            // Reference the auto-generated proxy for the hub.
            var guest = $.connection.guestHub;
            var refresh = $.connection.refreshPageHub;
            var information = $.connection.informationHub;
            var rssfeed = $.connection.rssfeedHub;

            // Create a function that the hub can call back to display messages.
            guest.client.update = function (model) {
                $.ajax({
                    type: "POST",
                    data: JSON.stringify(model),
                    url: "@Url.Action("TodaysGuestsPartial", "Kantine")",
                    contentType: "application/json"
                }).done(function (res) {
                    $('#todaysguests').html(res);
                });

            };

            information.client.update = function (model) {
                $.ajax({
                    type: "POST",
                    data: JSON.stringify(model),
                    url: "@Url.Action("InformationsPartial", "Kantine")",
                    contentType: "application/json"
                }).done(function (res) {
                    $('#informations').html(res);
                });

            };

            rssfeed.client.update = function (model) {
                $.ajax({
                    type: "POST",
                    data: JSON.stringify(model),
                    url: "@Url.Action("RSSFeedPartial", "Kantine")",
                    contentType: "application/json",
                }).success(function (res) {
                    $('#RSSFeed').html(res);
                });

            };

            refresh.client.refreshkantine = function () {
                // Add the message to the page.
                location.reload();
            };

            // Start the connection.
            $.connection.hub.start().done(function () {
                guest.server.updateGuest("Kantine");
                refresh.server.refreshPage("Kantine");
                information.server.updateInformation("Kantine");
                rssfeed.server.UpdateRssfeed("Kantine");

            });
        })
    </script>

    <script type="text/javascript">
        $(document).ready(function () {
            $('.carousel').carousel({
                interval: 45000
            })
        });

    </script>
}
<head>
    <link href="@Url.Content("~/Content/StyleSheet.css")" rel="stylesheet" type="text/css" />

</head>
<body>
    <!-----------------------------------Information and guests------------------------------------->
    <div id="SW" class="carousel slide panel" data-ride="carousel" data-interval="45000">

        <div class="carousel-inner">
            @{
                var firstInformation = Model.Informations.FirstOrDefault();
            }

            <div class="item active">
                <div id="todaysguests">
                    <div class="panel panel-primary" style="border:hidden;">
                        <div class="panel-heading" style="background-color:#42678A; border:none; padding:5px;">
                            <h1 class="panel-title" style="text-align:center; font-size:18px; border:none;"> Gæster idag</h1>
                        </div>
                        <div class="panel-body">

                            <div class="row">
                                <table class="table table-responsive table-striped" style="background-color:white; ">
                                    <tbody>
                                        @foreach (var item in Model.Guests)
                                        {
                                            <tr style="max-height:10px;">
                                                <td style="padding:0;"><h3 style="color:#42678A; margin-left:10px">@item.Name</h3></td>
                                                <td style="padding:0;"><h3 style="color:#42678A; font-weight:bold">@item.Company</h3></td>
                                                <td style="padding:0;"><img style=" max-height:50px; margin-top:3px;" src="~/Flags/@item.Country" /></td>
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                            </div>

                        </div>
                    </div>
                </div>

            </div>

            <div id="informations">
                @foreach (var item in Model.Informations)
                {
                    <div class="item">
                        <div class="panel panel-primary" style="border:none; box-shadow:none;">
                            <div class="panel-heading" style="background-color:#42678A;">
                                <h1 class="panel-title" style="text-align:center; font-size:24px;">Information</h1>
                            </div>
                            <div class="panel-body">
                                @Html.Raw(item.Body)
                            </div>
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>



    @*<div id="todaysguests">
            @Html.Partial("~/Views/Shared/PartialView/_TodaysGuests.cshtml", @Model.infoguestvm.Guests)
        </div>*@
    <!-----------------------------------Images------------------------------------->
    <div id="images">
        @Html.Partial("~/Views/Shared/PartialView/_BillederNW.cshtml", @Model.Images)
    </div>

    <!-----------------------------------Production------------------------------------->

    <div id="PTET">
        <div class="panel panel-primary" style="float: left; width:50%; height: 100%; border-bottom: none;border-color:#42678A;">
            <div class="panel-heading" style="background-color:#42678A; border:none; border-color:#42678A; padding:5px; ">
                <h1 class="panel-title" style="text-align:center; font-size:16px; padding:0;">Ekstrudering</h1>
            </div>
            <div>
                @if (Model.EkstruderingProd != "")
                {
                    <span class="helper"></span>
                    <img style="width:22vw; margin-left: auto; margin-right: auto; display: block;" src="@Url.Action("GetImg", "Kantine", new { path = Model.EkstruderingProd })" />
                }
            </div>
        </div>

        <div class="panel panel-primary" style="float: right; width:50%; height: 100%; border-bottom: none; border-color:#42678A;">
            <div class="panel-heading" style="background-color:#42678A; border:none; border-color:#42678A; padding:5px; ">
                <h1 class="panel-title" style="text-align:center; font-size:16px;">Termoform</h1>
            </div>
            <div>
                @if (Model.EkstruderingProd != "")
                {
                    <span class="helper"></span>
                    <img style="width:22vw; margin-left: auto; margin-right: auto; display: block;" src="@Url.Action("GetImg", "Kantine", new { path = Model.TermoformProd })" />
                }
            </div>

        </div>
    </div>


    <!--------------------------------------------------------------------------------------------->
    <div class="panel panel-primary" id="PTRapport" style="position: fixed;
    width: 50%;
    height: 65%;
    top: 30%;
    right: 0;
    background: #fff;">

        <div class="carousel slide" data-ride="carousel" data-interval="60000">
            @{
                var firstReport = Model.Reports.FirstOrDefault();
            }
            <!-- Wrapper for slides -->
            <div class="carousel-inner">
                @foreach (var item in Model.Reports)
                {
                    if (Model.Reports.Count() > 1)
                    {
                        if (item.Equals(firstReport))
                        {
                            <div class="item active">
                                <span class="helper"></span>
                                <img src="@Url.Action("GetImg", "Kantine", new { path = item.Path })" style="width: 45vw; margin: auto; display: block;" onerror="src='/Images/Skylight.png'" />
                            </div>

                        }
                        else
                        {
                            <div class="item">
                                <span class="helper"></span>
                                <img src="@Url.Action("GetImg", "Kantine", new { path = item.Path })" style="width: 45vw; margin: auto; display: block;" onerror="src='/Images/Skylight.png'" />
                            </div>
                        }
                    }
                    else
                    {
                        <div class="item active">
                            <span class="helper"></span>
                            <img src="@Url.Action("GetImg", "Kantine", new { path = item.Path })" style="width: 45vw; margin: auto; display: block;" />
                        </div>

                    }

                }
            </div>
        </div>
    </div>

    <!------------------------------------------------------------------------------------->
    <div id="RSSFeed">
        <div style="position:fixed; top:89%; left:0; bottom:10%; background:#ffffff; width:100%; border-top:solid; border-top-color: #f74b4b">
            <div style=" margin-left: 1%; display:inline-block; vertical-align:middle; margin-top:10px;">
                <img src=@Url.Content("~/Images/drLogo.jpg") style="height:5vh;" />
            </div>
            <div style="left:10%; width:90%; background:#ffffff; vertical-align:middle; margin-top:10px; display:inline-block; ">
                @*
                <marquee behavior="scroll" scrollamount="5" direction="left" style="font-size:16px; font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; color:black;">@Model.RSSFeedString</marquee>
                *@
                <p class="microsoft marquee">@Model.RSSFeed</p>
            </div>

        </div>
    </div>

</body>

